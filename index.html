<!DOCTYPE html>
<html lang="pt">
<head>
<meta charset="UTF-8">
<title>MeuFlix</title>
<link href="https://fonts.googleapis.com/css2?family=Roboto&display=swap" rel="stylesheet">
<style>
* { margin:0; padding:0; box-sizing:border-box; }
body { font-family:'Roboto',sans-serif; background:#141414; color:#fff; }

header { position: fixed; top:0; left:0; width:100%; height:60px; background:#141414; display:flex; align-items:center; justify-content:space-between; padding:0 40px; z-index:1000; box-shadow:0 2px 5px rgba(0,0,0,0.5); }
header h1 { color:#e50914; font-size:24px; cursor:pointer; }
nav { display:flex; gap:25px; }
nav div { cursor:pointer; transition:color .2s; }
nav div:hover { color:#e50914; text-decoration:underline; }

.banner { position: relative; width:100%; height:70vh; display:flex; flex-direction:column; justify-content:flex-end; padding:40px; overflow:hidden; }
.banner::after { content:''; position:absolute; top:0; left:0; width:100%; height:100%; background:linear-gradient(to top, rgba(20,20,20,0.9) 0%, rgba(20,20,20,0) 60%); z-index:1; }
.banner-content { position:relative; z-index:2; max-width:600px; display:flex; flex-direction:column; gap:15px; }
.banner h1 { font-size:48px; margin-bottom:10px; }
.banner p { font-size:18px; margin-bottom:20px; }
.banner-content button { width:160px; padding:12px 0; font-size:16px; border:none; border-radius:5px; cursor:pointer; font-weight:bold; transition: background .2s; }
.banner-content button.play { background:#fff; color:#000; }
.banner-content button.play:hover { background:#ddd; }
.banner-content button.lista { background:rgba(109,109,110,0.7); color:#fff; }
.banner-content button.lista:hover { background:rgba(109,109,110,0.5); }

#root { margin-top:80px; }

.fila-container { margin:20px 50px; position:relative; }
.fila-titulo { font-size:20px; margin-bottom:10px; font-weight:bold; }
.fila { display:flex; overflow-x:auto; gap:16px; padding-bottom:10px; scroll-behavior:smooth; scrollbar-width:none; }
.fila::-webkit-scrollbar { display:none; }
.filme { width:180px; height:270px; border-radius:5px; overflow:hidden; position:relative; flex-shrink:0; transition:transform .3s; }
.filme:hover { transform:scale(1.08); z-index:2; }
.filme img { width:100%; height:100%; object-fit:cover; display:block; }

.filme-hover-overlay { position:absolute; top:0; left:0; width:100%; height:100%; background: rgba(0,0,0,0.7); display:flex; justify-content:center; align-items:center; gap:10px; opacity:0; transition:opacity .3s; flex-direction:column; border-radius:5px; z-index:5; }
.filme:hover .filme-hover-overlay { opacity:1; }
.filme-hover-overlay button { width:100px; padding:8px 0; background:#e50914; border:none; color:#fff; font-weight:bold; cursor:pointer; border-radius:4px; transition: background .2s; }
.filme-hover-overlay button:hover { background:#b20710; }

.add-list-btn { position:absolute; bottom:5px; right:5px; width:30px; height:30px; border-radius:50%; border:none; background:#e50914; color:#fff; font-weight:bold; cursor:pointer; font-size:18px; z-index:6; transition: background .2s; opacity:0; }
.filme:hover .add-list-btn { opacity:1; }
.add-list-btn:hover { background:#b20710; }

.btn-scroll { position:absolute; top:50%; transform:translateY(-50%); background:rgba(0,0,0,.6); border:none; color:#fff; font-size:30px; width:40px; height:80px; cursor:pointer; z-index:10; border-radius:4px; display:flex; align-items:center; justify-content:center; }
.btn-scroll:hover { background:rgba(229,9,20,.8); }
.btn-left { left:0; }
.btn-right { right:0; }

.modal { display:none; position:fixed; z-index:10000; left:0; top:0; width:100%; height:100%; background:rgba(0,0,0,0.85); justify-content:center; align-items:center; }
.modal-content { background:#222; padding:25px; border-radius:10px; max-width:500px; width:90%; text-align:center; }
.modal h2 { margin-bottom:20px; }
.episodio-btn, .temporada-btn { display:block; margin:10px 0; padding:12px; background:#e50914; border:none; border-radius:5px; color:#fff; cursor:pointer; font-size:16px; width:100%; transition:background .2s; }
.episodio-btn:hover, .temporada-btn:hover { background:#b20710; }
.close-btn { margin-top:15px; padding:10px 20px; background:#555; border:none; border-radius:5px; color:#fff; cursor:pointer; transition:background .2s; }
.close-btn:hover { background:#333; }

.progresso { position:absolute; bottom:0; left:0; width:100%; height:5px; background-color:rgba(255,255,255,0.3); }
.progresso > div { height:100%; background-color:#e50914; width:0%; }

.toast-container { position: fixed; bottom: 20px; right: 20px; display: flex; flex-direction: column; gap: 10px; z-index: 20000; }
.toast { background: rgba(51, 51, 51, 0.95); color: #fff; padding: 12px 20px; border-radius: 5px; min-width: 220px; max-width: 300px; font-size: 14px; font-weight: bold; display: flex; align-items: center; justify-content: space-between; box-shadow: 0 2px 8px rgba(0,0,0,0.7); opacity: 0; transform: translateX(100%); animation: slideIn 0.5s forwards, fadeOut 0.5s forwards 3s; }
.toast button { background: none; border: none; color: #e50914; font-weight: bold; cursor: pointer; margin-left: 10px; }
@keyframes slideIn { to { opacity: 1; transform: translateX(0); } }
@keyframes fadeOut { to { opacity: 0; transform: translateX(100%); } }
</style>
</head>
<body>

<header>
<h1>MeuFlix</h1>
<nav>
<div onclick="mostrarSecao('inicio')">Página Inicial</div>
<div onclick="mostrarSecao('series')">Séries</div>
<div onclick="mostrarSecao('filmes')">Filmes</div>
<div onclick="mostrarSecao('terror')">Terror</div>
<div onclick="mostrarSecao('lista')">A Minha Lista</div>
</nav>
</header>

<div class="banner">
  <img id="bannerImage" src="https://images.justwatch.com/poster/334324389/s718/lilo-and-stitch-2025.jpg" style="width:100%; height:100%; object-fit:cover; position:absolute; top:0; left:0; z-index:0;">
  <video id="bannerVideo" style="display:none; width:100%; height:100%; object-fit:cover; position:absolute; top:0; left:0; z-index:0;" autoplay muted loop>
    <source src="http://localhost:8096/Videos/4e881aace3c877692082cd2e2f0fad64/stream.mp4?Static=true" type="video/mp4">
  </video>
  <div class="banner-content">
    <h1>Lilo & Stitch 2025</h1>
    <p>Uma animação divertida e emocionante para toda a família.</p>
    <button class="play" onclick="assistirItem(filmes[0])">▶ Assistir</button>
    <button class="lista" onclick="adicionarMinhaLista(filmes[0].titulo)">+ Minha Lista</button>
  </div>
</div>

<div id="root"></div>

<div id="modal" class="modal">
  <div class="modal-content" id="modalContent">
    <h2 id="modalTitle">Escolha a temporada</h2>
    <div id="episodiosList"></div>
    <button class="close-btn" onclick="fecharModal()">Fechar</button>
  </div>
</div>

<div id="toastContainer" class="toast-container"></div>

<script>
let minhaLista = [];
let progresso = {}; // { "Título": segundosAssistidos }

// ===== localStorage =====
function salvarLista() { localStorage.setItem("minhaLista", JSON.stringify(minhaLista)); }
function carregarLista() { const lista = localStorage.getItem("minhaLista"); if(lista) minhaLista=JSON.parse(lista); }
function salvarProgresso() { localStorage.setItem("progresso", JSON.stringify(progresso)); }
function carregarProgresso() { const p = localStorage.getItem("progresso"); if(p) progresso = JSON.parse(p); }

// ===== Toast =====
function mostrarToast(mensagem) {
  const container = document.getElementById('toastContainer');
  const toast = document.createElement('div'); toast.className='toast'; toast.textContent=mensagem;
  const btn = document.createElement('button'); btn.textContent='✖'; btn.onclick=()=>container.removeChild(toast);
  toast.appendChild(btn); container.appendChild(toast);
  setTimeout(()=>{ if(container.contains(toast)) container.removeChild(toast); }, 4000);
}

// ===== Lista =====
function adicionarMinhaLista(titulo){
  if(!minhaLista.includes(titulo)){
    minhaLista.push(titulo); salvarLista(); mostrarToast(`"${titulo}" adicionado à Minha Lista!`);
  } else { mostrarToast(`"${titulo}" já está na Minha Lista.`); }
  mostrarSecao('inicio'); // Atualiza fila "Minha Lista"
}

// ===== Dados =====
const filmes = [
  {titulo:"Lilo & Stitch 2025",img:"https://images.justwatch.com/poster/334324389/s718/lilo-and-stitch-2025.jpg",link:"http://localhost:8096/Videos/fd01e68f98ca97ffe2385321a8419563/stream.mp4?Static=true", trailer:"http://localhost:8096/Videos/4e881aace3c877692082cd2e2f0fad64/stream.mp4?Static=true"},
  {titulo:"O Discípulo",img:"https://imagens.publico.pt/imagens.aspx/1229973?tp=UH&db=IMAGENS&type=JPG&share=1&o=BarraFacebook_P3.png",link:"http://localhost:8096/Videos/5587dfc46083d69b9900fb4aa5e0527e/stream.mp4?Static=true", trailer:"http://localhost:8096/Videos/5587dfc46083d69b9900fb4aa5e0527e/stream.mp4?Static=true"}
];
const series = [
  {titulo:"Morangos com Açúcar",img:"https://m.media-amazon.com/images/S/pv-target-images/ed2fde424fa4ab359c5a3d6aca7922c5ae84e6fd4fd3d20afd25747c0952f761.png",
   temporadas:[
    {numero:1,episodios:[ {numero:1,link:"http://localhost:8096/Videos/6f9b24bdd4d4e2954b5a732a2e1faa05/stream.mp4?Static=true"}, {numero:2,link:"http://localhost:8096/Videos/27fe974c305e13eddc29256793078530/stream.mp4?Static=true"}, ...Array.from({length:8},(_,i)=>({numero:i+3,link:"#"}))]},
    {numero:2,episodios:Array.from({length:10},(_,i)=>({numero:i+1,link:"#"}))}
   ], trailer:"http://localhost:8096/Videos/4e881aace3c877692082cd2e2f0fad64/stream.mp4?Static=true"}
];
const filmesTerror = [
  {titulo:"A Maldição",img:"https://via.placeholder.com/180x270.png?text=A+Maldi%C3%A7%C3%A3o",link:"#",trailer:"#"},
  {titulo:"Noite Sombria",img:"https://via.placeholder.com/180x270.png?text=Noite+Sombria",link:"#",trailer:"#"},
  {titulo:"O Retorno do Horror",img:"https://via.placeholder.com/180x270.png?text=O+Retorno+do+Horror",link:"#",trailer:"#"}
];

// ===== Interface =====
function criarFila(idFila, lista, tipo, tituloFila){
  const container=document.createElement('div'); container.className='fila-container'; container.id=idFila;
  const titulo=document.createElement('div'); titulo.className='fila-titulo'; titulo.textContent=tituloFila|| (tipo==='filme'? (idFila==='fila3'?'Filmes de Terror':'Filmes Populares'):'Séries Populares');
  const btnLeft=document.createElement('button'); btnLeft.className='btn-scroll btn-left'; btnLeft.innerHTML='&#10094;';
  const btnRight=document.createElement('button'); btnRight.className='btn-scroll btn-right'; btnRight.innerHTML='&#10095;';
  const fila=document.createElement('div'); fila.className='fila'; fila.id=idFila+'-content';

  lista.forEach(item=>{
    const itemDiv=document.createElement('div'); itemDiv.className='filme';

    const img=document.createElement('img'); img.src=item.img; img.alt=item.titulo;

    const overlay=document.createElement('div'); overlay.className='filme-hover-overlay';
    const btnPlay=document.createElement('button'); btnPlay.textContent='▶ Assistir';
    btnPlay.onclick=(e)=>{ e.stopPropagation(); tipo==='filme'?assistirItem(item):abrirModalTemporadas(item); };
    const btnTrailer=document.createElement('button'); btnTrailer.textContent='▶ Trailer';
    btnTrailer.onclick=(e)=>{ e.stopPropagation(); if(item.trailer) window.open(item.trailer,'_blank'); };
    overlay.appendChild(btnPlay); overlay.appendChild(btnTrailer);

    itemDiv.appendChild(img); itemDiv.appendChild(overlay);

    const addBtn=document.createElement('button'); addBtn.className='add-list-btn';
    function updateButton() {
      if(minhaLista.includes(item.titulo)){ addBtn.textContent='✖'; addBtn.title='Remover da Minha Lista'; }
      else { addBtn.textContent='+'; addBtn.title='Adicionar à Minha Lista'; }
    }
    addBtn.onclick=(e)=>{ e.stopPropagation(); 
      if(minhaLista.includes(item.titulo)){ minhaLista=minhaLista.filter(t=>t!==item.titulo); mostrarToast(`"${item.titulo}" removido da Minha Lista!`); }
      else { minhaLista.push(item.titulo); mostrarToast(`"${item.titulo}" adicionado à Minha Lista!`); }
      salvarLista(); updateButton(); mostrarSecao('inicio'); 
    };
    updateButton(); itemDiv.appendChild(addBtn);

    // Barra de progresso
    if(progresso[item.titulo] && progresso[item.titulo]>0){
      const barra=document.createElement('div'); barra.className='progresso';
      const inner=document.createElement('div'); inner.style.width=Math.min(100,(progresso[item.titulo]/60)*100)+'%'; barra.appendChild(inner);
      itemDiv.appendChild(barra);
    }

    fila.appendChild(itemDiv);
  });

  container.appendChild(titulo); container.appendChild(btnLeft); container.appendChild(fila); container.appendChild(btnRight);
  btnLeft.addEventListener('click',()=>fila.scrollBy({left:-300,behavior:'smooth'}));
  btnRight.addEventListener('click',()=>fila.scrollBy({left:300,behavior:'smooth'}));
  return container;
}

function abrirModalTemporadas(serie){
  document.getElementById('modalTitle').textContent=`Escolha a temporada de "${serie.titulo}"`;
  const list=document.getElementById('episodiosList'); list.innerHTML='';
  serie.temporadas.forEach(temp=>{
    const btn=document.createElement('button'); btn.className='temporada-btn'; btn.textContent=`Temporada ${temp.numero}`;
    btn.onclick=()=>abrirModalEpisodios(temp,serie.titulo); list.appendChild(btn);
  });
  document.getElementById('modal').style.display='flex';
}

function abrirModalEpisodios(temporada, serieTitulo){
  document.getElementById('modalTitle').textContent=`Escolha o episódio - ${serieTitulo} (Temporada ${temporada.numero})`;
  const list=document.getElementById('episodiosList'); list.innerHTML='';
  temporada.episodios.forEach(ep=>{
    const btn=document.createElement('button'); btn.className='episodio-btn'; btn.textContent=`Episódio ${ep.numero}`;
    btn.onclick=()=>assistirItem(ep); list.appendChild(btn);
  });
}

function fecharModal(){ document.getElementById('modal').style.display='none'; }

function assistirItem(item){
  let tempo=progresso[item.titulo]||0;
  window.open(item.link+'#t='+tempo,'_blank');
  if(!tempo) progresso[item.titulo]=5;
  salvarProgresso(); mostrarSecao('inicio');
}

function mostrarSecao(secao){
  const root=document.getElementById('root'); root.innerHTML='';

  if(secao==='inicio'){
    if(minhaLista.length>0){
      const todosItens=[...filmes,...series,...filmesTerror];
      const itensLista=todosItens.filter(i=>minhaLista.includes(i.titulo));
      root.appendChild(criarFila('fila0',itensLista,'filme','Minha Lista'));
    }
    root.appendChild(criarFila('fila1',filmes,'filme'));
    root.appendChild(criarFila('fila2',series,'serie'));
    root.appendChild(criarFila('fila3',filmesTerror,'filme'));
  } else if(secao==='filmes'){ root.appendChild(criarFila('fila1',filmes,'filme')); } 
  else if(secao==='series'){ root.appendChild(criarFila('fila2',series,'serie')); } 
  else if(secao==='terror'){ root.appendChild(criarFila('fila3',filmesTerror,'filme')); } 
  else if(secao==='lista'){
    const listaContainer=document.createElement('div'); listaContainer.className='fila-container'; listaContainer.id='listaContainer';
    const tituloDiv=document.createElement('div'); tituloDiv.className='fila-titulo'; tituloDiv.textContent='Minha Lista'; listaContainer.appendChild(tituloDiv);
    const filaDiv=document.createElement('div'); filaDiv.className='fila';
    const todosItens=[...filmes,...series,...filmesTerror];
    minhaLista.forEach(titulo=>{
      const item=todosItens.find(i=>i.titulo===titulo);
      if(item){
        const card=criarFila('card'+titulo,[item],'filme'); filaDiv.appendChild(card.firstChild);
      }
    });
    listaContainer.appendChild(filaDiv); root.appendChild(listaContainer);
  }
}

// ===== Inicialização =====
carregarLista(); carregarProgresso(); mostrarSecao('inicio');

window.addEventListener('load', ()=>{
  const img=document.getElementById('bannerImage');
  const video=document.getElementById('bannerVideo');
  setTimeout(()=>{ img.style.display='none'; video.style.display='block'; video.play(); },2000);
});
</script>
</body>
</html>
